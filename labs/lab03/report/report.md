---
## Front matter
title: "Отчёт по лабораторной работе 3"
subtitle: "Анализ трафика в Wireshark"
author: "Гафоров Нурмухаммад"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Введение

## Цель работы  

Изучение посредством Wireshark кадров Ethernet, анализ PDU протоколов транспортного и прикладного уровней стека TCP/IP.

# Ход выполнения  

На рабочем компьютере был установлен и запущен анализатор сетевого трафика **Wireshark**. Для начала захвата данных выбран активный сетевой интерфейс Ethernet. После запуска фиксации пакетов в консоли Windows с помощью команды `ipconfig` были определены сетевые параметры устройства: IP-адрес **192.168.1.180**, маска подсети **255.255.255.0** и основной шлюз **192.168.1.1**.  

![Определение IP-адреса и шлюза по умолчанию](Screenshot_1.png){ #fig:001 width=80% }  

Далее был выполнен тест связи с шлюзом по умолчанию командой `ping 192.168.1.1`. Все пакеты успешно доставлены, потери отсутствовали, что подтвердило корректность сетевого подключения.  

![Проверка доступности шлюза](Screenshot_2.png){ #fig:002 width=80% }  

В процессе захвата трафика в **Wireshark** применён фильтр `arp or icmp`. В списке пакетов отобразились ICMP-запросы и ответы, соответствующие выполненной команде `ping`. В кадре ICMP-запроса длина составила 74 байта, тип кадра — **Ethernet II**. В поле источника указан MAC-адрес устройства **ASUSTeKCOMPu_7B:B6:F2**, а в поле назначения — MAC-адрес шлюза **HuaweiTechno_8F:73:82**.  

![ICMP Echo Request к шлюзу](Screenshot_3.png){ #fig:003 width=80% }  

В ICMP-ответе наблюдается обратная ситуация: источником выступает MAC-адрес шлюза, а получателем — MAC-адрес компьютера. Это подтверждает двусторонний обмен эхо-запросами между узлами.  

![ICMP Echo Reply от шлюза](Screenshot_4.png){ #fig:004 width=80% }  

При анализе кадров ARP установлено, что перед началом ICMP-обмена выполняется разрешение адреса шлюза. В кадрах ARP-запроса устройство отправляет широковещательное сообщение с запросом MAC-адреса для IP **192.168.1.1**, а в ARP-ответе шлюз возвращает свой физический адрес.  

![Анализ ARP-запроса](Screenshot_5.png){ #fig:005 width=80% }  

Затем начат новый процесс захвата трафика. В консоли выполнена команда `ping yandex.ru`, что позволило исследовать прохождение пакетов к удалённому узлу в сети Интернет. Все запросы успешно завершились с временем отклика около **8 мс**.  

![Проверка доступности внешнего ресурса](Screenshot_6.png){ #fig:006 width=80% }  

Применение фильтра `arp or icmp` показало обмен ICMP Echo Request и Echo Reply между локальным адресом **192.168.1.180** и удалённым сервером **77.88.55.88** (yandex.ru). На этапе разрешения адресов также фиксировались ARP-запросы к локальному шлюзу.  

![ICMP Echo Request к yandex.ru](Screenshot_7.png){ #fig:007 width=80% }  
![ICMP Echo Reply от yandex.ru](Screenshot_8.png){ #fig:008 width=80% }  
![ARP-запрос при взаимодействии с внешним ресурсом](Screenshot_9.png){ #fig:009 width=80% }  

Для анализа транспортных протоколов был запущен анализатор **Wireshark**. В качестве активного сетевого интерфейса выбран Ethernet. После начала захвата трафика в браузере был открыт сайт **CERN** по адресу `http://info.cern.ch/`.  

В ходе анализа пакетов использовались фильтры `http`, `dns` и `quic`, что позволило последовательно изучить работу протоколов **TCP**, **UDP** и **QUIC** на транспортном уровне.  

## Анализ HTTP и протокола TCP  

При фильтрации трафика по протоколу `http` в Wireshark были зафиксированы запросы **GET** и ответы **HTTP/1.1 304 Not Modified**. Каждый HTTP-пакет передаётся в рамках соединения **TCP**, обеспечивающего надёжную доставку данных.  

В заголовках пакетов TCP отображались порты источника и назначения (например, **50781 → 80**), что подтверждает стандартное использование порта 80 для HTTP. Также присутствовали управляющие флаги `PSH` и `ACK`, указывающие на передачу данных и подтверждение получения.  

![HTTP-запросы и ответы в Wireshark](Screenshot_10.png){ #fig:010 width=80% }  
![Пакет TCP с HTTP-запросом](Screenshot_11.png){ #fig:011 width=80% }  
![Ответ HTTP с кодом 304 Not Modified](Screenshot_12.png){ #fig:012 width=80% }  

## Анализ DNS и протокола UDP  

Для анализа разрешения имён применён фильтр `dns`. В Wireshark зафиксированы стандартные **DNS-запросы** к адресу шлюза **192.168.1.1** и **DNS-ответы**, содержащие сведения о найденных доменах.  

Передача данных происходила по протоколу **UDP**, что подтверждается указанием портов **53** (сервер DNS) и **50854** (клиент). В пакете запроса содержалось поле `Standard query`, а в ответе — `Standard query response, No error`, что свидетельствует об успешном разрешении имени.  

![DNS-запросы в Wireshark](Screenshot_13.png){ #fig:013 width=80% }  
![DNS-ответы от сервера](Screenshot_14.png){ #fig:014 width=80% }  

## Анализ протокола QUIC  

Для анализа современного транспортного протокола **QUIC** использовался фильтр `quic`. В захваченном трафике были зафиксированы пакеты типа **Initial**, **Handshake**, **PING** и **CRYPTO**, передаваемые по **UDP**.  

Каждый пакет содержал заголовок **QUIC IETF**, в котором указаны параметры соединения: `Packet Length`, `Connection ID`, `Packet Type` и `Token`. В кадрах фиксировались элементы обмена ключами шифрования и подтверждения соединения, характерные для работы QUIC поверх UDP.  

![Передача пакетов QUIC в Wireshark](Screenshot_15.png){ #fig:015 width=80% }  
![QUIC Initial и Handshake-пакеты](Screenshot_9.png){ #fig:016 width=80% }  

## Анализ handshake протокола TCP в Wireshark

Для анализа механизма установления соединения **TCP (handshake)** был запущен анализатор трафика **Wireshark**. В качестве активного сетевого интерфейса выбран Ethernet, после чего начат захват сетевых пакетов. Для генерации TCP-трафика использовалось подключение по протоколу **HTTP** к сайту **188.184.67.127 (info.cern.ch)**.  

В захваченном трафике в Wireshark применён фильтр `tcp`, что позволило выделить пакеты, относящиеся к установлению соединения. На экране отчётливо видна последовательность **трёхэтапного рукопожатия (Three-way handshake)**:  

1. **SYN** — клиент (192.168.1.180) инициирует соединение, отправляя сегмент с установленным флагом `SYN` и указанием начального номера последовательности (`Seq=0`, `Win=64240`).  
2. **SYN, ACK** — сервер (188.184.67.127) подтверждает запрос, устанавливая флаги `SYN` и `ACK`, а также возвращая свой номер последовательности (`Seq=0`, `Ack=1`).  
3. **ACK** — клиент отправляет подтверждение (`Ack=1`), завершая установление соединения.  

![Захват TCP handshake в Wireshark](Screenshot_16.png){ #fig:016 width=80% }  

После завершения рукопожатия начинается передача данных по протоколу **HTTP**. На кадрах видно, что клиент отправляет запрос `GET / HTTP/1.1`, а сервер отвечает сообщением `HTTP/1.1 304 Not Modified`. Это подтверждает, что соединение установлено корректно и используется для передачи прикладных данных.  

Дальнейший анализ статистики TCP, выполненный через меню **«Статистика → График потока (Flow Graph)**», демонстрирует временную диаграмму с обменом сегментами:  
- первые три пакета (SYN → SYN/ACK → ACK) образуют фазу установления соединения,  
- далее следуют сегменты передачи данных и завершения соединения (флаги `FIN, ACK`).  

![График потока](Screenshot_17.png){ #fig:017 width=80% }  

# Вывод

В ходе работы был проанализирован процесс установления соединения по протоколу **TCP** с использованием анализатора трафика **Wireshark**. Исследование показало, что трёхэтапное рукопожатие (**Three-Way Handshake**) обеспечивает надёжное установление соединения между клиентом и сервером перед началом передачи данных. В результате анализа зафиксированы стадии обмена сегментами **SYN**, **SYN/ACK** и **ACK**, подтверждающие успешную синхронизацию номеров последовательности и готовность сторон к коммуникации. Полученные данные подтверждают корректную реализацию транспортного уровня в модели OSI и демонстрируют принцип работы TCP при передаче HTTP-запросов.  