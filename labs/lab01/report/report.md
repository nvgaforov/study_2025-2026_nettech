---
## Front matter
title: "Отчёт по лабораторной работе 1"
subtitle: "Методы кодирования и модуляция сигналов"
author: "Гафоров Нурмухаммад"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Изучить методы кодирования и модуляции сигналов с использованием языка Octave. Определить спектры и параметры сигналов, исследовать свойства самосинхронизации.

# Выполнение работы

## Построение графиков в Octave

### Постановка задачи

Необходимо построить графики функций:

$$
y_1 = \sin(x) + \frac{1}{3}\sin(3x) + \frac{1}{5}\sin(5x),
$$

$$
y_2 = \cos(x) + \frac{1}{3}\cos(3x) + \frac{1}{5}\cos(5x),
$$

на интервале $$[-10; 10]$$, используя Octave и функцию `plot`. Графики требуется экспортировать в файлы формата `.eps` и `.png`.

### Порядок выполнения

В Octave был подготовлен сценарий, в котором:  
1. Задан интервал изменения аргумента $$x \in [-10; 10]$$.  
2. Определены функции $$y_1$$ и $$y_2$$.  
3. Сконструирован график функции $$y_1$$ и экспортирован в форматы `.eps` и `.png`.  
4. На одном графике построены функции $$y_1$$ и $$y_2$$, добавлена легенда для удобства анализа.  

### Полученные результаты

Первым был получен график функции $$y_1$$:  

![График функции y1](plot-sin.png){ #fig:001 width=80% }

Далее приведён представлены оба графика функций $$y_1$$ и $$y_2$$:  

![Графики функций y1 и y2](plot-sin-cos.png){ #fig:002 width=80% }

##  Разложение импульсного сигнала в частичный ряд Фурье

### Постановка задачи
Необходимо сгенерировать набор графиков приближений меандра при увеличении числа нечётных гармоник. Рассматриваются два варианта разложения: через cos-ряд и через sin-ряд.  

### Исходные параметры моделирования
- число используемых гармоник: 8  
- временной интервал: от -1 до 1 с шагом 0.01  
- амплитуда: 1  
- период: 1  
В частотном составе меандра задействованы только нечётные гармоники, амплитуда которых обратно пропорциональна их номеру.  

### Порядок выполнения
1. Построены графики частичных сумм ряда Фурье, приближающих меандр, при числе гармоник от 1 до 8.  
2. Реализовано моделирование как через cos-ряд (с чередующимися знаками членов), так и через sin-ряд (с положительными членами).  
3. Каждый частичный ряд показан в отдельной ячейке окна, что позволяет наглядно видеть процесс приближения.  
4. Полученные графики экспортированы в формат `.png`.  

### Полученные результаты моделирования
Построены зависимости частичных сумм косинусного ряда:  

![Меандр через cos-ряд (N=1…8)](meandr.png){ #fig:003 width=80% }

Построены зависимости частичных сумм синусного ряда:  

![Меандр через sin-ряд (N=1…8)](meandr2.png){ #fig:004 width=80% }

### Интерпретация результатов результатов
- При малом числе гармоник сигнал имеет плавную форму и плохо напоминает меандр.  
- С увеличением количества гармоник фронты становятся более крутыми, форма сигнала всё ближе к прямоугольной.  
- Вблизи разрывов наблюдаются колебания (эффект Гиббса), которые сохраняются при любом числе гармоник, но их ширина уменьшается.  
- Cos- и sin-разложения дают эквивалентное приближение меандра при одинаковом числе гармоник.  

## Определение спектра и параметров сигнала

### Постановка задачи
Поставлена задача определить спектры двух отдельных сигналов (синусоидальных колебаний различной частоты) и их суммы. Также требуется рассмотреть случай изменения частоты дискретизации и объяснить, что произойдёт при её уменьшении ниже 80 Гц.

### Порядок выполнения
1. В каталоге `spectre1` заданы параметры: длительность сигнала 0.5 с, частота дискретизации 512 Гц, частоты сигналов 10 Гц и 40 Гц, амплитуды 1 и 0.7.  
2. Сформированы два синусоидальных сигнала:  
   $$
   s_1(t) = a_1 \sin(2\pi f_1 t), \quad s_2(t) = a_2 \sin(2\pi f_2 t).
   $$  
3. Выполнено построение сигналов и их спектров с использованием БПФ.  
4. Произведена корректировка спектров: удалены отрицательные частоты, произведена нормировка амплитуд.  
5. В каталоге `spectre_sum` построен суммарный сигнал и найден его спектр.  

### Результаты
График двух исходных сигналов:  

![Два синусоидальных сигнала](spectre1/signal/spectre.png){ #fig:005 width=80% }

Спектры сигналов до исправления:  

![Спектры сигналов](spectre1/spectre/spectre.png){ #fig:006 width=80% }

Исправленные спектры сигналов:  

![Исправленный спектр](spectre1/spectre/spectre_fix.png){ #fig:007 width=80% }

Общий сигнал:  

![Общий сигнал](spectre_sum/signal/spectre_sum.png){ #fig:008 width=80% }

Спектр суммарного сигнала:  

![Спектр суммы](spectre_sum/spectre/spectre_sum.png){ #fig:009 width=80% }

### Основные выводы
- При дискретизации 512 Гц сигналы с частотами 10 Гц и 40 Гц корректно отображаются, спектры чётко выделены.  
- Спектр суммы сигналов совпадает с суммой отдельных спектров, что подтверждает свойства преобразования Фурье.  
- Если частота дискретизации будет меньше 80 Гц, то сигнал с частотой 40 Гц не сможет корректно отобразиться: произойдёт наложение спектров (алиасинг), что приведёт к искажению сигнала.  
- Для корректного представления сигнала частота дискретизации должна быть как минимум в два раза выше максимальной частоты спектра (критерий Найквиста–Котельникова).  

## Амплитудная модуляция

### Постановка задачи
Требовалось показать принципы амплитудной модуляции (АМ) на примере модуляции низкочастотного сигнала синусоидой высокой частоты и исследовать спектр полученного сигнала.

### Порядок выполнения
1. В рабочем каталоге создан сценарий `am.m` и заданы параметры моделирования:  
   - длительность сигнала: 0.5 с,  
   - частота дискретизации: 512 Гц,  
   - частота модулирующего сигнала: 5 Гц,  
   - частота несущей: 50 Гц.  

2. Были заданы сигналы:  
   - модулирующий сигнал $$s_1(t) = \sin(2\pi f_1 t)$$,  
   - несущая $$s_2(t) = \sin(2\pi f_2 t)$$,  
   - амплитудно-модулированный сигнал $$s(t) = s_1(t) \cdot s_2(t)$$.  

3. Сконструирован график модулированного сигнала вместе с огибающей.  

4. Через БПФ рассчитан спектр модулированного сигнала.  

### Результаты
График амплитудно-модулированного сигнала с огибающей:  

![АМ-сигнал и огибающая](modulation/signal/am.png){ #fig:010 width=80% }

Спектр амплитудно-модулированного сигнала:  

![Спектр АМ-сигнала](modulation/spectre/am.png){ #fig:011 width=80% }

### Основные выводы
- Амплитудная модуляция заключается в изменении амплитуды высокочастотной несущей в зависимости от низкочастотного модулирующего сигнала.  
- На графике чётко видна огибающая, совпадающая с модулирующим сигналом.  
- Спектр модулированного сигнала состоит из центральной частоты (несущей) и двух боковых полос, расположенных симметрично относительно несущей на расстоянии частоты модуляции.  
- Полученные результаты подтверждают принцип свёртки спектров при умножении сигналов во временной области.  


## Кодирование сигнала и исследование самосинхронизации

### Постановка задачи
Нужно было сгенерировать кодовые последовательности по заданным битовым последовательностям для нескольких линийных кодов. Проверить самосинхронизацию на длинных сериях одинаковых символов. Построить спектры сигналов и сравнить энергетическое распределение.

### Порядок выполнения
1. Было подготовлено три выборки данных: основная последовательность для визуализации формы сигнала; последовательность для проверки самосинхронизации с длинными сериями нулей/единиц; последовательность для расчёта спектров.
2. Для каждого кода получены три вида результатов: форма сигнала, иллюстрация самосинхронизации, амплитудный спектр.
3. Изученные виды кодирования: Unipolar, AMI, Bipolar NRZ, Bipolar RZ, Manchester, Differential Manchester.

### Графики сигналов (основная последовательность)
Unipolar  
![Unipolar (сигнал)](coding/signal/unipolar.png){ #fig:012 width=80% }

AMI  
![AMI (сигнал)](coding/signal/ami.png){ #fig:013 width=80% }

Bipolar NRZ  
![Bipolar NRZ (сигнал)](coding/signal/bipolarnrz.png){ #fig:014 width=80%

Bipolar RZ  
![Bipolar RZ (сигнал)](coding/signal/bipolarrz.png){ #fig:015 width=80% }

Manchester  
![Manchester (сигнал)](coding/signal/manchester.png){ #fig:016 width=80% }

Differential Manchester  
![Differential Manchester (сигнал)](coding/signal/diffmanc.png){ #fig:017 width=80% }

### Иллюстрации самосинхронизации (длинные серии)
Unipolar  
![Unipolar (sync)](coding/sync/unipolar.png){ #fig:018 width=80% }

AMI  
![AMI (sync)](coding/sync/ami.png){ #fig:019 width=80% }

Bipolar NRZ  
![Bipolar NRZ (sync)](coding/sync/bipolarnrz.png){ #fig:020 width=80% }

Bipolar RZ  
![Bipolar RZ (sync)](coding/sync/bipolarrz.png){  #fig:021 width=80% }

Manchester  
![Manchester (sync)](coding/sync/manchester.png){  #fig:022 width=80% }

Differential Manchester  
![Differential Manchester (sync)](coding/sync/diffmanc.png){  #fig:023 width=80% }

### Графики спектров
Unipolar  
![Unipolar (спектр)](coding/spectre/unipolar.png){ #fig:024 width=80% }

AMI  
![AMI (спектр)](coding/spectre/ami.png){  #fig:025 width=80% }

Bipolar NRZ  
![Bipolar NRZ (спектр)](coding/spectre/bipolarnrz.png){  #fig:026 width=80% }

Bipolar RZ  
![Bipolar RZ (спектр)](coding/spectre/bipolarrz.png){ #fig:027 width=80% }

Manchester  
![Manchester (спектр)](coding/spectre/manchester.png){ #fig:028 width=80% }

Differential Manchester  
![Differential Manchester (спектр)](coding/spectre/diffmanc.png){ #fig:029 width=80% }

### Интерпретация результатов
Unipolar  
Нет инверсий на длинной серии нулей. Сильная DC-составляющая. Самосинхронизация отсутствует на последовательностях с малой числом переходов.

AMI  
Единицы чередуют полярность, что исключает DC и облегчает обнаружение ошибок полярности. На длинной серии нулей переходов нет, самосинхронизация ухудшается. Применяются вставки скреймблинга/подстановочные шаблоны для ограничения длины серии нулей.

Bipolar NRZ  
Переходы только при смене бита. На длинной серии одинаковых символов переходов нет, синхронизация теряется. DC подавлена слабее, чем у AMI.

Bipolar RZ  
Возврат к нулю в каждом такте создаёт обязательный переход внутри бита. Самосинхронизация выше, чем у NRZ/Unipolar. Ширина спектра больше из-за удвоения числа фронтов.

Manchester  
Переход в середине каждого такта обеспечивает самосинхронизацию даже на одинаковых сериях. Отсутствует DC-составляющая. Эффективная полоса вдвое шире относительно исходной битовой скорости.

Differential Manchester  
Сохранены свойства Manchester по самосинхронизации и отсутствию DC. Информация кодируется изменением/сохранением фазы относительно предыдущего такта, что повышает устойчивость к инверсии полярности канала.

Сопоставление по спектру  
Unipolar показывает выраженный низкочастотный пик (DC). AMI и биполярные коды подавляют DC и концентрируют энергию в области тактовых частот и гармоник переходов. RZ и Manchester расширяют спектр за счёт обязательных переходов середины такта. Differential Manchester аналогичен Manchester по ширине спектра.

Коды с принудительными переходами (RZ, Manchester, Differential Manchester) демонстрируют лучшую самосинхронизацию ценой увеличенной полосы. AMI эффективен по спектру и отсутствию DC, но требует мер против длинных серий нулей. Unipolar и Bipolar NRZ чувствительны к синхронизации при малом числе переходов и имеют менее благоприятные спектральные свойства.

# Вывод

В ходе лабораторной работы были реализованы методы построения сигналов, их спектральный анализ, амплитудная модуляция и различные способы кодирования. Полученные графики подтвердили теоретические положения о разложении в ряд Фурье, свойстве самосинхронизации и спектральных характеристиках сигналов. Практическая работа в Octave закрепила понимание методов обработки сигналов.

